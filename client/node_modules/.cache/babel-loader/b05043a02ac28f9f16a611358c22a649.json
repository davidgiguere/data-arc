{"ast":null,"code":"import _slicedToArray from \"/Users/erikwoodworth/Coding/ARC/data-arc/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/erikwoodworth/Coding/ARC/data-arc/src/components/LayoutWrapper/index.js\";\nimport React, { useState, useEffect } from 'react'; // import ReactGridLayout from 'react-grid-layout';\n\nimport { Grid, Row, Col } from 'react-flexbox-grid';\nimport defaults from '../../config/defaults'; // import DataTable from '../Table';\n\nimport TableSE from '../Table-SE';\nimport DataSelector from '../DataSelector';\nimport MapWrapper from '../MapWrapper';\nimport ChartWrapper from '../ChartWrapper';\nimport { ExportToCsv } from 'export-to-csv';\nimport Loader from 'react-loader-spinner';\nimport API from '../../utils/API';\nimport './style.css';\nimport ColorRamp from '../Legends/ColorRamp'; // import DataManifest from '../../config/DataManifest.json'\n\nimport OpenDataManifest from '../../config/OpenDataManifest';\n\nvar LayoutWrapper = function LayoutWrapper(props) {\n  // console.log(DataManifest);\n  var _useState = useState({\n    mapVisible: defaults.layout.mapView.visible,\n    tableVisible: defaults.layout.tableView.visible,\n    chartVisible: defaults.layout.chartView.visible,\n    colorMap: 'spring',\n    numberOfBins: 72,\n    colorMapReverse: false,\n    // chartType: 'scatterplot',\n    colorOpacity: .8,\n    tableBanding: ['#c8e4d6', '#f3eeeb']\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      layout = _useState2[0],\n      setLayout = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      serviceID = _useState4[0],\n      setServiceID = _useState4[1];\n\n  var _useState5 = useState('Change'),\n      _useState6 = _slicedToArray(_useState5, 2),\n      labelManifest = _useState6[0],\n      setLabelManifest = _useState6[1];\n\n  var _useState7 = useState('NAME'),\n      _useState8 = _slicedToArray(_useState7, 2),\n      sortField = _useState8[0],\n      setSortField = _useState8[1];\n\n  var _useState9 = useState('lohi'),\n      _useState10 = _slicedToArray(_useState9, 2),\n      sortOrder = _useState10[0],\n      setSortOrder = _useState10[1];\n\n  var _useState11 = useState('County'),\n      _useState12 = _slicedToArray(_useState11, 2),\n      sumLevel = _useState12[0],\n      setSumLevel = _useState12[1]; // const [plngRegion, setPlngRegion] = useState('ARC 10')\n\n\n  var _useState13 = useState(['NAME', 'GEOID']),\n      _useState14 = _slicedToArray(_useState13, 2),\n      selectedFields = _useState14[0],\n      setSelectedFields = _useState14[1];\n\n  var _useState15 = useState('GEOID'),\n      _useState16 = _slicedToArray(_useState15, 2),\n      hoverField = _useState16[0],\n      setHoverField = _useState16[1];\n\n  var _useState17 = useState(),\n      _useState18 = _slicedToArray(_useState17, 2),\n      hoverID = _useState18[0],\n      setHoverID = _useState18[1];\n\n  var _useState19 = useState(),\n      _useState20 = _slicedToArray(_useState19, 2),\n      fieldOptions = _useState20[0],\n      setFieldOptions = _useState20[1];\n\n  var _useState21 = useState('TotPop_00'),\n      _useState22 = _slicedToArray(_useState21, 2),\n      mapField = _useState22[0],\n      setMapField = _useState22[1];\n\n  var _useState23 = useState(),\n      _useState24 = _slicedToArray(_useState23, 2),\n      data = _useState24[0],\n      setData = _useState24[1];\n\n  var _useState25 = useState(),\n      _useState26 = _slicedToArray(_useState25, 2),\n      csvData = _useState26[0],\n      setCSVData = _useState26[1];\n\n  var _useState27 = useState('nodata'),\n      _useState28 = _slicedToArray(_useState27, 2),\n      csvStatus = _useState28[0],\n      setCSVStatus = _useState28[1];\n\n  var _useState29 = useState('geojson'),\n      _useState30 = _slicedToArray(_useState29, 2),\n      fileType = _useState30[0],\n      setFileType = _useState30[1];\n\n  var getData = function getData(baseurl, categoryID, geo, fields) {\n    // console.log(geo)\n    setData(); // setSelectedFields(['NAME','GEOID']);\n    // const excludeFields = [\n    //     'GEOID_1',\n    //     'GlobalID',\n    //     'LogRecNo',\n    //     'GEOID',\n    //     'SumLevel',\n    //     'NAME',\n    //     'County10',\n    //     'County20',\n    //     'PLNG_REGIO',\n    //     'created_date',\n    //     'created_user',\n    //     'last_edited_data',\n    //     'last_edited_user'\n    // ];\n\n    setFieldOptions();\n    setSelectedFields(['NAME', 'GEOID']);\n    var url = \"\".concat(baseurl).concat(categoryID, \"/query?where=SumLevel='\").concat(geo, \"'&outFields=\").concat(fields, \"&f=\").concat(fileType);\n    API.getData(url).then(function (res) {\n      // console.log(labelManifest);\n      console.log(res); // console.log(fileType)\n\n      var optionsArray = fileType === 'json' ? res.data.fields.map(function (field) {\n        return {\n          key: field.name,\n          text: field.alias,\n          value: field.name\n        };\n      }) : fileType === 'geojson' ? OpenDataManifest[labelManifest].filter(function (fieldObject) {\n        return labelManifest === 'RaceX' ? fieldObject.Category === 'N/A' || fieldObject.Category === defaults.categoryOptions.find(function (item) {\n          return item.value === serviceID;\n        }).subcategory : true;\n      }).map(function (fieldObj) {\n        return {\n          key: fieldObj.Variable,\n          text: fieldObj.Long,\n          value: fieldObj.Variable\n        };\n      } // Object.keys(res.data.features[0].properties)\n      //     .map(field =>  \n      //         ({\n      //             key : field,\n      //             text : OpenDataManifest[labelManifest].map(item => item.Variable === field ? item.Long : undefined), \n      //             value : field\n      //         })\n      ) : fieldOptions; // console.log(optionsArray);\n\n      setData(res.data);\n      setFieldOptions(optionsArray);\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  };\n\n  var handleSortField = function handleSortField(fieldAlias, sortOrder) {\n    setSortField(fieldAlias);\n    setSortOrder(sortOrder);\n  };\n\n  var handleHover = function handleHover(featureID) {\n    setHoverID(featureID);\n  }; // For CSV Export\n\n\n  var handleCSVData = function handleCSVData(baseurl, categoryID, geo, fields) {\n    var url = \"\".concat(baseurl).concat(categoryID, \"/query?where=SumLevel='\").concat(geo, \"'&returnGeometry=false&outFields=\").concat(fields, \"&f=json\");\n    API.getData(url).then(function (res) {\n      // console.log(res.data.features);\n      var dataArray = res.data.features.map(function (feature) {\n        return feature.attributes;\n      }); // console.log(dataArray);\n\n      setCSVData(dataArray);\n      setCSVStatus('ready');\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  };\n\n  var downloadCSV = function downloadCSV() {\n    var csvFilename = sumLevel + '-' + serviceID.toString() + '-download';\n    var csvTitle = 'Test';\n    var csvOptions = {\n      fieldSeparator: ',',\n      quoteStrings: '\"',\n      decimalSeparator: '.',\n      filename: csvFilename,\n      showTitle: false,\n      title: csvTitle,\n      useTextFile: false,\n      useKeysAsHeaders: true // headers: ['Column 1', 'Column 2', etc...] <-- Won't work with useKeysAsHeaders present!\n\n    };\n    var csvExporter = new ExportToCsv(csvOptions);\n    csvExporter.generateCsv(csvData);\n    setCSVData();\n    setCSVStatus('nodata');\n  };\n\n  useEffect(function () {\n    return getData(defaults.data.baseUrl, serviceID, sumLevel, '*');\n  }, [serviceID, sumLevel]);\n  return React.createElement(Grid, {\n    fluid: true,\n    style: {\n      height: '100vh'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, React.createElement(Row, {\n    style: {\n      height: '15vh'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, React.createElement(DataSelector, {\n    setServiceID: setServiceID,\n    setSelectedFields: setSelectedFields,\n    setFieldOptions: setFieldOptions,\n    setLabelManifest: setLabelManifest,\n    handleCSVData: handleCSVData,\n    downloadCSV: downloadCSV,\n    setCSVStatus: setCSVStatus,\n    setCSVData: setCSVData,\n    setSumLevel: setSumLevel,\n    setMapField: setMapField,\n    serviceID: serviceID,\n    sumLevel: sumLevel,\n    data: data,\n    selectedFields: selectedFields,\n    csvStatus: csvStatus,\n    fieldOptions: fieldOptions,\n    hoverField: hoverField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  })), React.createElement(Row, {\n    style: {\n      height: '80vh'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }, React.createElement(Col, {\n    sm: 12,\n    lg: 6,\n    style: {\n      height: '100%',\n      width: '100%'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, React.createElement(Row, {\n    className: \"no-scrollbar\",\n    middle: \"sm\",\n    style: {\n      padding: '10px 30px 0px 30px',\n      height: '50%',\n      width: '100%',\n      overflow: 'scroll'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }, layout.tableVisible && data ? // <DataTable\n  //     selectedFields={selectedFields} \n  //     data={data}\n  //     sortField={sortField}\n  //     handleSortField={handleSortField}\n  //     sortOrder={sortOrder}\n  //     hoverID={hoverID}\n  //     handleHover={handleHover}\n  //     hoverField={hoverField}\n  // /> \n  React.createElement(TableSE, {\n    selectedFields: selectedFields,\n    data: data,\n    sortField: sortField,\n    handleSortField: handleSortField,\n    sortOrder: sortOrder,\n    hoverID: hoverID,\n    handleHover: handleHover,\n    hoverField: hoverField,\n    labelManifest: labelManifest,\n    layout: layout,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212\n    },\n    __self: this\n  }) : React.createElement(\"div\", {\n    style: {\n      position: 'relative',\n      width: '100%',\n      textAlign: 'center'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225\n    },\n    __self: this\n  }, React.createElement(Loader, {\n    id: \"loader-box\",\n    type: \"Grid\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226\n    },\n    __self: this\n  }))), React.createElement(Row, {\n    center: \"sm\",\n    middle: \"sm\",\n    style: {\n      height: '50%',\n      width: '100%',\n      zIndex: '99999'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229\n    },\n    __self: this\n  }, layout.chartVisible && data ? React.createElement(ChartWrapper, {\n    selectedVariable: mapField,\n    data: data,\n    layout: layout,\n    handleHover: handleHover,\n    hoverID: hoverID,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231\n    },\n    __self: this\n  }) : React.createElement(\"div\", {\n    style: {\n      position: 'relative',\n      width: '100%',\n      textAlign: 'center'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238\n    },\n    __self: this\n  }, React.createElement(Loader, {\n    id: \"loader-box\",\n    type: \"Audio\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239\n    },\n    __self: this\n  })))), React.createElement(Col, {\n    sm: 12,\n    lg: 6,\n    style: {\n      height: '100%'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243\n    },\n    __self: this\n  }, layout.mapVisible ? React.createElement(MapWrapper, {\n    hoverID: hoverID,\n    handleHover: handleHover,\n    hoverField: hoverField,\n    selectedVariable: mapField,\n    layout: layout,\n    data: data,\n    labelManifest: labelManifest,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245\n    },\n    __self: this\n  }) : React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253\n    },\n    __self: this\n  }, \"Map not loading\"), React.createElement(ColorRamp, {\n    selectedVariable: mapField,\n    data: data,\n    layout: layout,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254\n    },\n    __self: this\n  }))));\n};\n\nexport default LayoutWrapper;","map":{"version":3,"sources":["/Users/erikwoodworth/Coding/ARC/data-arc/src/components/LayoutWrapper/index.js"],"names":["React","useState","useEffect","Grid","Row","Col","defaults","TableSE","DataSelector","MapWrapper","ChartWrapper","ExportToCsv","Loader","API","ColorRamp","OpenDataManifest","LayoutWrapper","props","mapVisible","layout","mapView","visible","tableVisible","tableView","chartVisible","chartView","colorMap","numberOfBins","colorMapReverse","colorOpacity","tableBanding","setLayout","serviceID","setServiceID","labelManifest","setLabelManifest","sortField","setSortField","sortOrder","setSortOrder","sumLevel","setSumLevel","selectedFields","setSelectedFields","hoverField","setHoverField","hoverID","setHoverID","fieldOptions","setFieldOptions","mapField","setMapField","data","setData","csvData","setCSVData","csvStatus","setCSVStatus","fileType","setFileType","getData","baseurl","categoryID","geo","fields","url","then","res","console","log","optionsArray","map","field","key","name","text","alias","value","filter","fieldObject","Category","categoryOptions","find","item","subcategory","fieldObj","Variable","Long","catch","err","handleSortField","fieldAlias","handleHover","featureID","handleCSVData","dataArray","features","feature","attributes","downloadCSV","csvFilename","toString","csvTitle","csvOptions","fieldSeparator","quoteStrings","decimalSeparator","filename","showTitle","title","useTextFile","useKeysAsHeaders","csvExporter","generateCsv","baseUrl","height","width","padding","overflow","position","textAlign","zIndex"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\n// import ReactGridLayout from 'react-grid-layout';\nimport {Grid, Row, Col} from 'react-flexbox-grid';\nimport defaults from '../../config/defaults';\n// import DataTable from '../Table';\nimport TableSE from '../Table-SE';\nimport DataSelector from '../DataSelector';\nimport MapWrapper from '../MapWrapper';\nimport ChartWrapper from '../ChartWrapper';\nimport { ExportToCsv } from 'export-to-csv';\nimport Loader from 'react-loader-spinner';\nimport API from '../../utils/API'\nimport './style.css';\nimport ColorRamp from '../Legends/ColorRamp';\n// import DataManifest from '../../config/DataManifest.json'\nimport OpenDataManifest from '../../config/OpenDataManifest';\n\nconst LayoutWrapper = props => {\n\n    // console.log(DataManifest);\n\n    const [layout, setLayout] = useState({\n        mapVisible: defaults.layout.mapView.visible,\n        tableVisible: defaults.layout.tableView.visible,\n        chartVisible: defaults.layout.chartView.visible,\n        colorMap: 'spring',\n        numberOfBins: 72,\n        colorMapReverse: false,\n        // chartType: 'scatterplot',\n        colorOpacity: .8,\n        tableBanding: ['#c8e4d6', '#f3eeeb']\n    });\n\n    const [serviceID, setServiceID] = useState(0);\n    const [labelManifest, setLabelManifest] = useState('Change');\n    const [sortField, setSortField] = useState('NAME');\n    const [sortOrder, setSortOrder] = useState('lohi');\n    const [sumLevel, setSumLevel] = useState('County');\n    // const [plngRegion, setPlngRegion] = useState('ARC 10')\n    const [selectedFields, setSelectedFields] = useState(['NAME', 'GEOID']);\n    const [hoverField, setHoverField] = useState('GEOID');\n    const [hoverID, setHoverID] = useState();\n    const [fieldOptions, setFieldOptions] = useState();\n    const [mapField, setMapField] = useState('TotPop_00')\n    const [data, setData] = useState();\n    const [csvData, setCSVData] = useState();\n    const [csvStatus, setCSVStatus] = useState('nodata');\n    const [fileType, setFileType] = useState('geojson');\n\n\n    const getData = (baseurl, categoryID, geo, fields) => {\n        // console.log(geo)\n        setData();\n\n        // setSelectedFields(['NAME','GEOID']);\n\n        // const excludeFields = [\n        //     'GEOID_1',\n        //     'GlobalID',\n        //     'LogRecNo',\n        //     'GEOID',\n        //     'SumLevel',\n        //     'NAME',\n        //     'County10',\n        //     'County20',\n        //     'PLNG_REGIO',\n        //     'created_date',\n        //     'created_user',\n        //     'last_edited_data',\n        //     'last_edited_user'\n        // ];\n\n\n        setFieldOptions();\n        setSelectedFields(['NAME', 'GEOID'])\n        \n        const url = `${baseurl}${categoryID}/query?where=SumLevel='${geo}'&outFields=${fields}&f=${fileType}`;\n        \n        API.getData(url)\n            .then(res => {\n                // console.log(labelManifest);\n                console.log(res);\n                // console.log(fileType)\n                const optionsArray = fileType === 'json' ?\n                res.data.fields.map(field => \n                    ({\n                        key : field.name,\n                        text : field.alias,\n                        value : field.name\n                    })\n                ) : fileType === 'geojson' ? \n                    OpenDataManifest[labelManifest].filter(fieldObject => \n                        labelManifest === 'RaceX' ? \n                        fieldObject.Category === 'N/A' ||\n                        fieldObject.Category === defaults.categoryOptions.find(item => item.value === serviceID).subcategory : true )\n                        .map(fieldObj => \n                        ({\n                            key : fieldObj.Variable,\n                            text : fieldObj.Long, \n                            value : fieldObj.Variable \n                        })\n\n                    // Object.keys(res.data.features[0].properties)\n                    //     .map(field =>  \n                    //         ({\n                    //             key : field,\n                    //             text : OpenDataManifest[labelManifest].map(item => item.Variable === field ? item.Long : undefined), \n                    //             value : field\n                    //         })\n                ) : fieldOptions;\n                                        \n                // console.log(optionsArray);\n                setData(res.data);\n                setFieldOptions(optionsArray);\n            })\n            .catch(err => console.log(err));\n\n    }\n\n    const handleSortField = (fieldAlias, sortOrder) => {\n        setSortField(fieldAlias);\n        setSortOrder(sortOrder);\n    }\n\n    const handleHover = featureID => {\n        setHoverID(featureID);\n      }\n\n\n\n    // For CSV Export\n\n    const handleCSVData = (baseurl, categoryID, geo, fields) => {\n        const url = `${baseurl}${categoryID}/query?where=SumLevel='${geo}'&returnGeometry=false&outFields=${fields}&f=json`;\n\n        API.getData(url)\n            .then(res => {\n                // console.log(res.data.features);\n                const dataArray = res.data.features.map(feature => feature.attributes);\n                // console.log(dataArray);\n                setCSVData(dataArray);\n                setCSVStatus('ready');\n            })\n            .catch(err => console.log(err))\n    }\n\n    const downloadCSV = () => {\n        const csvFilename = sumLevel + '-' + serviceID.toString() +  '-download';\n        const csvTitle = 'Test';\n    \n        const csvOptions = \n            { \n                fieldSeparator: ',',\n                quoteStrings: '\"',\n                decimalSeparator: '.',\n                filename: csvFilename, \n                showTitle: false,\n                title: csvTitle,\n                useTextFile: false,\n                useKeysAsHeaders: true,\n                // headers: ['Column 1', 'Column 2', etc...] <-- Won't work with useKeysAsHeaders present!\n            };\n\n        const csvExporter = new ExportToCsv(csvOptions);\n\n        csvExporter.generateCsv(csvData);\n        \n        setCSVData();\n        setCSVStatus('nodata');\n    }\n\n\n    useEffect(() => getData(defaults.data.baseUrl, serviceID, sumLevel, '*'), [serviceID, sumLevel]);\n    \n    return (\n        <Grid fluid style={{height: '100vh'}}>\n            <Row style={{height: '15vh'}}>\n                <DataSelector\n                    setServiceID={setServiceID}\n                    setSelectedFields={setSelectedFields}\n                    setFieldOptions={setFieldOptions}\n                    setLabelManifest={setLabelManifest}\n                    handleCSVData={handleCSVData}\n                    downloadCSV={downloadCSV}\n                    setCSVStatus={setCSVStatus}\n                    setCSVData={setCSVData}\n                    setSumLevel={setSumLevel}\n                    setMapField={setMapField}\n                    serviceID={serviceID}\n                    sumLevel={sumLevel}\n                    data={data}\n                    selectedFields={selectedFields}\n                    csvStatus={csvStatus}\n                    fieldOptions={fieldOptions}\n                    hoverField={hoverField}\n                />\n            </Row>\n            <Row style={{height: '80vh'}}>\n                <Col sm={12} lg={6} style={{height: '100%', width: '100%'}}>\n                    <Row className='no-scrollbar' middle='sm' style={{padding: '10px 30px 0px 30px', height: '50%', width: '100%', overflow: 'scroll'}}>\n                        { layout.tableVisible && data ?\n                        // <DataTable\n                        //     selectedFields={selectedFields} \n                        //     data={data}\n                        //     sortField={sortField}\n                        //     handleSortField={handleSortField}\n                        //     sortOrder={sortOrder}\n                        //     hoverID={hoverID}\n                        //     handleHover={handleHover}\n                        //     hoverField={hoverField}\n                        // /> \n                        <TableSE\n                            selectedFields={selectedFields} \n                            data={data}\n                            sortField={sortField}\n                            handleSortField={handleSortField}\n                            sortOrder={sortOrder}\n                            hoverID={hoverID}\n                            handleHover={handleHover}\n                            hoverField={hoverField}\n                            labelManifest={labelManifest}\n                            layout={layout}\n                        />\n                        : \n                        <div style={{position: 'relative', width: '100%', textAlign: 'center'}}>\n                            <Loader id='loader-box' type='Grid' />\n                        </div>}\n                    </Row>\n                    <Row center='sm' middle='sm' style={{height: '50%', width: '100%', zIndex: '99999'}}>\n                        { layout.chartVisible && data ? \n                        <ChartWrapper \n                            selectedVariable={mapField}\n                            data={data} \n                            layout={layout}\n                            handleHover={handleHover}\n                            hoverID={hoverID} \n                        />  : \n                        <div style={{position: 'relative', width: '100%', textAlign: 'center'}}>\n                            <Loader id='loader-box' type='Audio' />\n                        </div> }\n                    </Row>\n                </Col>\n                <Col sm={12} lg={6} style={{height: '100%'}}>  \n                    { layout.mapVisible ? \n                    <MapWrapper\n                        hoverID={hoverID}\n                        handleHover={handleHover}\n                        hoverField={hoverField} \n                        selectedVariable={mapField} \n                        layout={layout} \n                        data={data}\n                        labelManifest={labelManifest} /> \n                    : <h1>Map not loading</h1> }\n                    <ColorRamp selectedVariable={mapField} data={data} layout={layout} />\n                </Col>\n            </Row>\n        </Grid>\n    );\n}\n\nexport default LayoutWrapper;"]},"metadata":{},"sourceType":"module"}